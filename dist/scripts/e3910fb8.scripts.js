"use strict";var goodMorningAngularApp=angular.module("goodMorningAngularApp",["ui.bootstrap","ngCookies","authServices","stickyServices","bookmarkServices","velibstationServices","newsstreamServices","weatherreportServices","kunidayServices","kunidayFilters"]);goodMorningAngularApp.config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"views/preauth.html",controller:"PreAuthCtrl"}).when("/home",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/weather",{templateUrl:"views/weather.html",controller:"WeatherCtrl"}).when("/kunidays",{templateUrl:"views/kunidays.html",controller:"KunidaysCtrl"}).when("/news",{templateUrl:"views/newsstreams.html",controller:"NewsStreamCtrl"}).when("/bookmarks",{templateUrl:"views/bookmarks.html",controller:"BookmarksCtrl"}).when("/preferences",{templateUrl:"views/preferences.html",controller:"PreferencesCtrl"}).otherwise({redirectTo:"/"})}]),goodMorningAngularApp.factory("goodMorningInterceptor",["$q","$location","$rootScope","$cookieStore",function(a,b,c,d){return function(a){var e=function(a){return a},f=function(){d.remove("authToken"),c.logged=!1,b.path("/")};return a.then(e,f)}}]),goodMorningAngularApp.config(["$httpProvider",function(a){a.responseInterceptors.push("goodMorningInterceptor")}]),goodMorningAngularApp.run(["$rootScope","$cookieStore",function(a,b){a.logged=(a.authToken=b.get("authToken"))?!0:!1,a.weatherBackground="neutral-background"}]),Date.prototype.getWeek=function(){var a=this;a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7));var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864e5+b.getDay()+1)/7)},goodMorningAngularApp.controller("MainCtrl",["$scope","$filter","$cookieStore","StickyBoard","Bookmark","WeatherReport","VelibStation","KuniDaySingle",function(a,b,c,d,e,f,g,h){var i=c.get("authToken"),j=new Date;new Date(j.getFullYear(),12,31),a.hours=j.getHours(),a.wday=j.getDay(),a.bookmarks=e.query({authToken:i}),a.orderBookmarks="id",a.reverseBookmarks=!0,a.velibStations=g.query({authToken:i}),a.sticky=d.pull({authToken:i}),a.kuniDay=h.today({authToken:i}),a.weatherReport=f.home({authToken:i}),a.pushStickyboard=function(){i=c.get("authToken"),d.push({authToken:i},{content:this.sticky.content})},a.pullStickyboard=function(){i=c.get("authToken"),a.sticky=d.pull({authToken:i})}}]),goodMorningAngularApp.controller("PreAuthCtrl",["$scope",function(){}]),goodMorningAngularApp.controller("AuthCtrl",["$scope","$rootScope","$location","$cookieStore","Auth",function(a,b,c,d,e){a.email=usernamePrefill,a.password=passwordPrefill,a.isCollapsed=!0,a.signin=function(){var f=e.signin({email:this.email,password:this.password},function(){d.put("authToken",f.authentication_token),a.authToken=f.authentication_token,a.username=f.user.email,b.logged=!0,c.path("/home/")})},a.signout=function(){var a=d.get("authToken");e.signout({authToken:a},function(){d.remove("authToken"),b.logged=!1,c.path("/")})}}]),goodMorningAngularApp.controller("NewsStreamCtrl",["$scope","$cookieStore","$dialog","NewsStream","NewsStreamSingle",function(a,b,c,d,e){var f=b.get("authToken");a.alerts=[],a.newsStreams=d.query({authToken:f});var g={keyboard:!1,backdropClick:!0,templateUrl:"views/newsstream_box.html",controller:"NewsStreamBoxCtrl"};a.newsStreamBox=function(b){if(null!=b&&void 0!=b)var e=b;else var e=null;c.dialog(angular.extend(g,{resolve:{item:function(){return angular.copy(e)}}})).open().then(function(b){b&&(b.created_at==b.updated_at?(a.newsStreams=d.query({authToken:f}),a.alerts.push({type:"success",msg:"News stream successfully added."})):(angular.copy(b,e),a.alerts.push({type:"success",msg:"News stream successfully updated."}))),e=void 0})},a.removeStream=function(b){e.remove({authToken:f,id:b},function(){a.alerts.push({type:"success",msg:"News stream successfully deleted."}),a.newsStreams=d.query({authToken:f})},function(){a.alerts.push({type:"error",msg:"News stream not deleted!"})})}}]),goodMorningAngularApp.controller("NewsStreamBoxCtrl",["$scope","$cookieStore","dialog","item","NewsStream","NewsStreamSingle",function(a,b,c,d,e,f){var g=b.get("authToken");a.item=d,a.save=function(){null==d?e.create({authToken:g},{title:a.item.title,url:a.item.url},function(a){c.close(a)},function(){a.alerts.push({type:"error",msg:"News stream not added!"})}):f.update({authToken:g,id:a.item.id},{title:a.item.title,url:a.item.url},function(){c.close(a.item)},function(){a.alerts.push({type:"error",msg:"News stream not updated!"})})},a.cancel=function(){c.close(!1)}}]),goodMorningAngularApp.controller("BookmarksCtrl",["$scope","$cookieStore","$dialog","Bookmark","BookmarkSingle",function(a,b,c,d,e){var f=b.get("authToken");a.alerts=[],a.bookmarks=d.query({authToken:f}),a.orderBookmarks="id",a.reverseBookmarks=!0;var g={keyboard:!1,backdropClick:!0,templateUrl:"views/bookmark_box.html",controller:"BookmarkBoxCtrl"};a.bookmarkBox=function(b){if(null!=b&&void 0!=b)var e=b;else var e=null;c.dialog(angular.extend(g,{resolve:{item:function(){return angular.copy(e)}}})).open().then(function(b){b&&(b.created_at==b.updated_at?(a.bookmarks=d.query({authToken:f}),a.alerts.push({type:"success",msg:"Bookmark successfully created."})):(angular.copy(b,e),a.alerts.push({type:"success",msg:"Bookmark successfully updated."}))),e=void 0})},a.deleteBookmark=function(b,c){e.remove({authToken:f,id:b},function(){a.bookmarks.splice(c,1),a.alerts.push({type:"success",msg:"Bookmark successfully deleted."})},function(){a.alerts.push({type:"error",msg:"Bookmark not deleted!"})})},a.closeAlert=function(b){a.alerts.splice(b,1)}}]),goodMorningAngularApp.controller("BookmarkBoxCtrl",["$scope","$cookieStore","dialog","item","Bookmark","BookmarkSingle",function(a,b,c,d,e,f){var g=b.get("authToken");a.item=d,a.save=function(){null==d?e.create({authToken:g},{title:a.item.title,url:a.item.url,description:a.item.description},function(a){c.close(a)},function(){a.alerts.push({type:"error",msg:"Bookmark not created!"})}):f.update({authToken:g,id:a.item.id},{title:a.item.title,url:a.item.url,description:a.item.description},function(){c.close(a.item)},function(){a.alerts.push({type:"error",msg:"Bookmark not updated!"})})},a.cancel=function(){c.close(!1)}}]),goodMorningAngularApp.controller("WeatherCtrl",["$scope","$rootScope","$cookieStore","WeatherReport",function(a,b,c,d){var e=c.get("authToken");d.full({authToken:e},function(b){a.hourly=b.hourly,a.forecast=b.forecast.simpleforecast.forecastday})}]),goodMorningAngularApp.controller("KunidaysCtrl",["$scope","$filter","$cookieStore","KuniDay",function(a,b,c,d){var e=c.get("authToken"),f=new Date,g=new Date(f.getFullYear(),12,31);a.hours=f.getHours(),a.wday=f.getDay(),a.kuniDays=d.query({authToken:e}),a.tWeek=f.getWeek(),a.tYear=f.getFullYear(),a.tWeek==g.getWeek()?(a.nWeek=1,a.nYear=a.tYear+1):(a.nWeek=a.tWeek+1,a.nYear=a.tYear),a.kuniSwitch=function(c,f,g,h,i){void 0==i&&(i="");var j=[{id:0,status:""},{id:1,status:"kt1"},{id:2,status:"kt2"},{id:3,status:"free"},{id:4,status:"unsure"}],k=b("filter")(j,i);if(4==k[0].id)var l=0;else var l=k[0].id+1;void 0==a.kuniDays[f][g]&&(a.kuniDays[f][g]={}),a.kuniDays[f][g][h]=j[l].status,d.save({authToken:e},{year:c,week:f,weekday:g,am:a.kuniDays[f][g].am,pm:a.kuniDays[f][g].pm})}}]),goodMorningAngularApp.controller("PreferencesCtrl",["$scope",function(){}]),angular.module("authServices",["ngResource"]).factory("Auth",["$resource","$cookieStore",function(a){return a(backendUrl+"users/:action.json?authentication_token=:authToken",{},{signin:{method:"POST",params:{action:"sign_in"}},signout:{method:"DELETE",params:{action:"sign_out"}}})}]),angular.module("stickyServices",["ngResource","ngCookies"]).factory("StickyBoard",["$resource","$cookieStore",function(a){return a(backendUrl+"stickyboards/:stickyId.json?authentication_token=:authToken",{stickyId:1},{push:{method:"PUT"},pull:{method:"GET"}})}]),angular.module("bookmarkServices",["ngResource","ngCookies"]).factory("Bookmark",["$resource","$cookieStore",function(a){return a(backendUrl+"bookmarks.json?authentication_token=:authToken",{},{create:{method:"POST"}})}]).factory("BookmarkSingle",["$resource",function(a){return a(backendUrl+"bookmarks/:id.json?authentication_token=:authToken",{},{update:{method:"PUT"}})}]),angular.module("weatherreportServices",["ngResource"]).factory("WeatherReport",["$resource",function(a){return a(backendUrl+"weatherreports/:action.json?authentication_token=:authToken",{},{home:{method:"GET",params:{action:"home"},isArray:!1},full:{method:"GET",params:{action:"full"},isArray:!1}})}]),angular.module("velibstationServices",["ngResource"]).factory("VelibStation",["$resource",function(a){return a(backendUrl+"velibstations.json?authentication_token=:authToken",{},{})}]),angular.module("newsstreamServices",["ngResource"]).factory("NewsStream",["$resource",function(a){return a(backendUrl+"newsstreams.json?authentication_token=:authToken",{},{create:{method:"POST"}})}]).factory("NewsStreamSingle",["$resource",function(a){return a(backendUrl+"newsstreams/:id.json?authentication_token=:authToken",{},{update:{method:"PUT"}})}]),angular.module("kunidayServices",["ngResource"]).factory("KuniDay",["$resource",function(a){return a(backendUrl+"kunidays.json?authentication_token=:authToken",{},{query:{method:"GET",params:{},isArray:!1},save:{method:"POST",params:{},isArray:!1}})}]).factory("KuniDaySingle",["$resource",function(a){var b=new Date,c=b.getFullYear()+"-"+("0"+(b.getMonth()+1)).slice(-2)+"-"+("0"+b.getDate()).slice(-2);return a(backendUrl+"kunidays/:date.json?authentication_token=:authToken",{},{today:{method:"GET",params:{date:c},isArray:!1}})}]),angular.module("kunidayFilters",[]).filter("KuniLabel",function(){var a={free:"label-info",kt1:"label-important",kt2:"label-important",unsure:"label-warning"};return function(b){return a[b]}});var url=window.document.URL;-1!=url.indexOf("localhost:9000")||-1!=url.indexOf("localhost:8080")?(backendUrl="http://localhost\\:3000/",usernamePrefill="demo@sabu.fr",passwordPrefill="password"):-1!=url.indexOf("192.168.1.91")?(backendUrl="http://192.168.1.91\\:8016/",usernamePrefill="marin.jeremy@gmail.com",passwordPrefill=""):-1!=url.indexOf("grosgg.no-ip.org:8015")?(backendUrl="http://grosgg.no-ip.org\\:8016/",usernamePrefill="marin.jeremy@gmail.com",passwordPrefill=""):(backendUrl="http://grosgg.no-ip.org\\:8026/",usernamePrefill="demo@sabu.fr",passwordPrefill="password");